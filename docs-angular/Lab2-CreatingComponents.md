# Lab 2 - Creating Components

During this lab you will create components with the Angular CLI to display high scores and add new scores using the Angular `FormBuilder`. You will learn how to navigate to these components using Angular `Routing`.

Goals for this lab:

- [Creating and displaying components](#inspect)
- [Displaying high scores in a list](#manage)
- [Creating an add score form using FormBuilder](#working)

## Creating and displaying components

### 1. Create the component with the Angular CLI

The following will create a component where you are going to show high scores

```sh
ng generate component high-scores/high-scores-list --module=app

# --module=app selects the AppModule to auto import this generated component

# You can also write the command short-handed:
# ng g c high-scores/high-scores-list --module=app
```

The script created a component folder `./angular-application/src/app/high-scores/high-scores-list` containing 4 files:

**\*.component.ts**

- The typescript file connects with the .html and scss files. This file will also contain all the logic for the component.

**\*.component.spec.ts**

- With the spec class you are able to unit test your component. 

**\*.component.html**

- This will show your content.

**\*.component.scss**

- The scss file styles the component.

The Angular CLI command also added your component to the `AppModule`. You can find this file in `./angular-application/src/app/app.module.ts`

```ts
@NgModule({
  declarations: [
    AppComponent,
    // Automatically added component
    HighScoresListComponent
    // #end
  ],
  imports: [
    /* ... */
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

In the `AppModule` you declare what components are available for use in your application.

### 2. Display the component

Make the following changes to the `AppRoutingModule` which is automatically generated by the boiletplate Angular application `./angular-application/src/app/app-routing.module.ts`

```ts
const routes: Routes = [
  // Add this route
  {
    path: "",
    component: HighScoresListComponent
  },
  // #end
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule {}
```

The `app-high-scores-list` component is now the homepage of the Angular application

### 3. Run the application

```
npm start
```

You should now see the contents of the component: "high-scores-list works!"

> #### Suggestion
> 
> Run the application to see the following: "high-scores-list works!"

## Displaying high scores in a list

For this chapter you will need the component you created in the previous chapter: `./angular-application/src/app/high-scores/high-scores-list/*`

### 1. Create a model to hold high scores

Create a the following file `./angular-application/src/shared/models/high-score.ts`

```ts
interface HighScore {
  nickname: string;
  game: string;
  points: number;
}
```

The `high-score.ts` is in a shared folder, so it can easily be used throughout the whole application when the application grows larger.

> **interface vs class**
>
> An interface is used because you are only interested in the properties (signature) of a high score. Later you will see that these properties directly map onto the results from the API.

### 2. Create a list of high scores

Create a list of high scores in the following file `./angular-application/src/app/high-scores/high-scores-list/high-scores-list.component.ts`
 
```ts
@Component({
  selector: "app-high-scores-list",
  templateUrl: "./high-scores-list.component.html",
  styleUrls: ["./high-scores-list.component.scss"]
})
export class HighScoresListComponent implements OnInit {
  public highScores: HighScore[];

  constructor() {}

  ngOnInit() {
    this.highScores = [
      {
        nickname: "LX360" /* Alex Thissen gamertag */,
        game: "Pac-Man",
        points: 96070
      },
      {
        nickname: "Who is Thijs" /* Thijs Limmen gamertag */,
        game: "Space Invaders",
        points: 7028
      }
    ];
  }
}
```

### 3. Display high scores using Material components

Display the high scores in the following file `./angular-application/src/app/high-scores/high-scores-list/high-scores-list.component.html`

``` html
<mat-list>
  <mat-list-item *ngFor="let highScore of highScores">
    <mat-icon matListIcon>dvr</mat-icon>
    <h3 matLine>{{ highScore.game }}: {{ highScore.points }}</h3>
    <p matLine>{{ highScore.nickname }}</p>
  </mat-list-item>
</mat-list>
```
 
- \<mat-list-item> is again an example of a Material component, which is imported in the `AppMaterialModule`
- **matListIcon** is an Angular directive which makes sure the icon is aligned left of the text.
- **matLine** is an Angular directive which adds additional functionality to the html components (showing text below eachother).

> #### Suggestion
> 
> Run the application to view the high scores list

## Creating an add score form using FormBuilder

In this chapter you are going to create a new page, navigate to it and display a form using the Angular `FormBuilder`, TODO: reactive components

### 1. Create a new add score page

Create a new component, just like you did with the high scores

```sh
ng generate component high-scores/add-score --module=app

# --module=app selects the AppModule to auto import this generated component
```

The following component is generated:  `./angular-application/src/app/high-scores/add-score/*`

### 2. Navigate to the add score page

- Make the following changes to the Routing Module `./angular-application/src/app/app-routing.module.ts`

```ts
const routes: Routes = [
  {
    path: "",
    component: HighScoresListComponent
  },
  // Add add score route
  {
    path: "add-score",
    component: AddScoreComponent
  }
  // #end
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule {}
```

- Add a (router)Link to the `add-score` page

Add the following to the high-scores-list component `./angular-application/src/app/high-scores/high-scores-list/high-scores-list.component.html`

```html
<mat-list>
  <!-- ... -->
</mat-list>

<!-- Added link -->
<a mat-button color="primary" [routerLink]="['/add-score']">Submit new Score</a>
<!-- #end -->
```

You could optionally also add a routerlink in the material Toolbar in file `./angular-application/src/app/app.component.html`

```html
<mat-toolbar color="primary">
  <mat-toolbar-row>
    <!-- ... -->
    <a mat-icon-button color="white" [routerLink]="['/add-score']">
      <mat-icon>add</mat-icon>
    </a>
  </mat-toolbar-row>
</mat-toolbar>
<!-- ... -->
```

### 3. Create a form with Material Input components

Create a new form with Material components in the new add score component `./angular-application/src/app/high-scores/add-score/add-score.component.scss`

```html
<form class="add-score-form">
  <mat-form-field class="input-nickname">
    <input matInput formControlName="nickname" required placeholder="Nickname" />
  </mat-form-field>

  <mat-form-field class="input-game">
    <mat-label>Games</mat-label>
    <mat-select formControlName="game">
      <mat-option value="developerdays">Developer Days</mat-option>
      <mat-option value="alarmclock">Alarm Clock</mat-option>
      <mat-option value="linesofcode">Lines of Code</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field>
    <input matInput formControlName="points" type="number" placeholder="Points" value="0" />
  </mat-form-field>

  <button class="form-button" (click)="submitScore()" mat-raised-button color="primary">
    Submit Score
  </button>
</form>
```

In this form you see the following:
- Material Input and Material Select components to enhance the form
- `formControlName` for using Angular Reactive Forms in a moment
- `required` to mark input as required
- `(click)="submitScore()"` which will call a function inside the typescript component file.

Let's add some style to the component for better spacing `./angular-application/src/app/high-scores/add-score/add-score.component.scss`

```scss
.add-score-form {
  margin: 16px;
  max-width: 600px;

  .input-nickname {
    width: 100%;
  }

  .input-game {
    margin-right: 20px;
  }

  .form-button {
    display: block;
  }
}
```

As you can see above the css classes are nested, which means only classes within `.add-score-form` are affected, for example: `.add-score-form .input-nickname` in casual CSS.



### 4. Use Reactive Forms to add scores

Add the `ReactiveFormsModule` to the `AppModule` in file `./angular-application/src/app/app.module.ts`

```ts
@NgModule({
  declarations: [
    /* ... */
  ],
  imports: [
    /* ... */
    /* Add this module */
    ReactiveFormsModule
    /* #end */
  ],
  providers: [],
  bootstrap: [AppComponent]
})
export class AppModule { }
```

Create the form using Angular `FormBuilder` in file `./angular-application/src/app/high-scores/add-score/add-score.component.ts`

```ts
@Component({
  selector: "app-add-score",
  templateUrl: "./add-score.component.html",
  styleUrls: ["./add-score.component.scss"]
})
export class AddScoreComponent implements OnInit {
  addScoreForm: FormGroup;

  constructor(private fb: FormBuilder) {}

  ngOnInit() {
    this.addScoreForm = this.fb.group({
      nickname: ["", Validators.required]],
      game: [""],
      points: [0]
    });
  }

  submitScore(): void {
    console.log(this.addScoreForm.value);
  }
}
```

Also make the following changes to the html in file `./angular-application/src/app/high-scores/add-score/add-score.component.html` to attach the `addScoreForm`. The properties in the created `addScoreForm` map to the `formControlName` in the html file. 

```html
<!-- add [formGroup]="addScoreForm" to the <form> -->
<form class="add-score-form" [formGroup]="addScoreForm">
<!-- #end -->
  <!-- ... -->


  <!-- Show status of the addScoreForm -->
  <p>
    Form Status: {{ addScoreForm.status }}
  </p>
  <!-- #end -->
  <!-- ... -->
</form>
```


> #### Suggestion:
>
> Run the application and press the button. you should now see the values of the form logged to your developer console. Press F12 in Google Chrome for example to view the logs.


> #### Pro tip:
>
> Go to https://angular.io/guide/reactive-forms to learn more about Angular Reactive Forms


## Wrap up

In this lab